```
 ▄▄▄       ██▀███   ███▄    █  ▒█████      ██ ▄█▀ ▒█████  ▓█████  ██░ ██  ██▓    ▓█████  ██▀███  
▒████▄    ▓██ ▒ ██▒ ██ ▀█   █ ▒██▒  ██▒    ██▄█▒ ▒██▒  ██▒▓█   ▀ ▓██░ ██▒▓██▒    ▓█   ▀ ▓██ ▒ ██▒
▒██  ▀█▄  ▓██ ░▄█ ▒▓██  ▀█ ██▒▒██░  ██▒   ▓███▄░ ▒██░  ██▒▒███   ▒██▀▀██░▒██░    ▒███   ▓██ ░▄█ ▒
░██▄▄▄▄██ ▒██▀▀█▄  ▓██▒  ▐▌██▒▒██   ██░   ▓██ █▄ ▒██   ██░▒▓█  ▄ ░▓█ ░██ ▒██░    ▒▓█  ▄ ▒██▀▀█▄  
 ▓█   ▓██▒░██▓ ▒██▒▒██░   ▓██░░ ████▓▒░   ▒██▒ █▄░ ████▓▒░░▒████▒░▓█▒░██▓░██████▒░▒████▒░██▓ ▒██▒
 ▒▒   ▓▒█░░ ▒▓ ░▒▓░░ ▒░   ▒ ▒ ░ ▒░▒░▒░    ▒ ▒▒ ▓▒░ ▒░▒░▒░ ░░ ▒░ ░ ▒ ░░▒░▒░ ▒░▓  ░░░ ▒░ ░░ ▒▓ ░▒▓░
  ▒   ▒▒ ░  ░▒ ░ ▒░░ ░░   ░ ▒░  ░ ▒ ▒░    ░ ░▒ ▒░  ░ ▒ ▒░  ░ ░  ░ ▒ ░▒░ ░░ ░ ▒  ░ ░ ░  ░  ░▒ ░ ▒░
  ░   ▒     ░░   ░    ░   ░ ░ ░ ░ ░ ▒     ░ ░░ ░ ░ ░ ░ ▒     ░    ░  ░░ ░  ░ ░      ░     ░░   ░ 
      ░  ░   ░              ░     ░ ░     ░  ░       ░ ░     ░  ░ ░  ░  ░    ░  ░   ░  ░   ░     
                                                                                                 
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.*##(((#(#(((#%######*,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,/&&&&%#/((%#(#(//((((#%%%####%&&#*,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,/%%#%%((#%(%#(/#%#%&@@@@@@@@@@@&&&&&#,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,(###%%&#(&#%%%%&%%&&@@@%#(%%####((####%&&&#,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,*%%##%%&##(%%%%&&&%#&@&(#(%#%%%&&@@&&&%#%%%&&@&(,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,*#%&%#%%####(%#%#%###%###%%%#%%%%%%&@@@@@&@&&&&&&*,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,**#&&%%#(///((/((((/((//////(//((##%&&@@@@@@@&&&&/,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,*/&&%#(//**,,,,,,,...,.......,,,,,,*(#%&&@@@@&&/,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,*%%%#(/***,,,............ ........,,,//#%@@@@&%*,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,%%%#(/**,,,,,...........    .......,***#&@@@&#,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,#%%(/**,,,,,,,.....................,,**#%%&&&*,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,#%#(***,,,,,.......................,,*/#&&&&%*,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,*%(/**,,,,,,.....................,,,,*/%&&&&#,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,*/#(/*****,,,,..,...................,**/#&&&%/,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,*(##/(##((/(###((/**,,,,***////*/****,*/*(%%%/*,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,/(/((///#///#((/(((,...*//(//%(##%#/////*/##/***,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,//((**,,,*******,**,...,,,*,*,*,.,,,,,,**/((,,,*,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,//#/*,,,......,,***,...,,,............,,*/(//,.*,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,////*,,......,,***,......,.............,*/#/,*,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,////*,,.,,,*///**,.......,,,,,,......,,*/##*,,,*,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,*((/***/(((((#%%(/***/((//,,,*(*,..,,*/(##,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,*#(/*/((///((((##(((((#((///*//(*,,*//##(/*,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,(#(//##(#&&#((/////////(((#((((/**/((%%*,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,*/#%####/**/(.,..., ..,.,/(**((/*/((#%%#,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,*(&%%%#(/***,,*/(///*,,,,,,///((###%%%/,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,**%&&%#(/**,,,***,,,,,,,,,*/((#%%%%%%%/,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,*(&&%%#((/*********,,,,**/(#%%%%%%%/.%#,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,*%&%%##(///****/****//(####%&%&%%/..(&&(,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,*((%&%%%%(((((/////(/((##%%%%&%%(,. .%&&&&*,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,/#%&&&@&(,/#%%&%###(((#(####%%%%%%%%#,..  .#&&&&&&#*,,,,,,,,,
,,,,,,,,,*/(%&&&&&&&&&&&&&%.,*#((#%%%%#%%%#%%%%%%%%#%*. . .. #&&&&&&&&&&&/,,,,,,
,,*(%&&&&&&&&&&&&&&&&&&&&&..,,(#((((###%%%%%%%%###/.    .. *%&&&&&&&&&&&&&&&#,,,


```

I work at sourcelabs will leave you all at the 1st of September but for now:

```
▄▄▄█████▓ ██▀███   ▄▄▄       ███▄    █   ██████  ▄▄▄       ▄████▄  ▄▄▄█████▓ ██▓ ▒█████   ███▄    █   ██████ 
▓  ██▒ ▓▒▓██ ▒ ██▒▒████▄     ██ ▀█   █ ▒██    ▒ ▒████▄    ▒██▀ ▀█  ▓  ██▒ ▓▒▓██▒▒██▒  ██▒ ██ ▀█   █ ▒██    ▒ 
▒ ▓██░ ▒░▓██ ░▄█ ▒▒██  ▀█▄  ▓██  ▀█ ██▒░ ▓██▄   ▒██  ▀█▄  ▒▓█    ▄ ▒ ▓██░ ▒░▒██▒▒██░  ██▒▓██  ▀█ ██▒░ ▓██▄   
░ ▓██▓ ░ ▒██▀▀█▄  ░██▄▄▄▄██ ▓██▒  ▐▌██▒  ▒   ██▒░██▄▄▄▄██ ▒▓▓▄ ▄██▒░ ▓██▓ ░ ░██░▒██   ██░▓██▒  ▐▌██▒  ▒   ██▒
  ▒██▒ ░ ░██▓ ▒██▒ ▓█   ▓██▒▒██░   ▓██░▒██████▒▒ ▓█   ▓██▒▒ ▓███▀ ░  ▒██▒ ░ ░██░░ ████▓▒░▒██░   ▓██░▒██████▒▒
  ▒ ░░   ░ ▒▓ ░▒▓░ ▒▒   ▓▒█░░ ▒░   ▒ ▒ ▒ ▒▓▒ ▒ ░ ▒▒   ▓▒█░░ ░▒ ▒  ░  ▒ ░░   ░▓  ░ ▒░▒░▒░ ░ ▒░   ▒ ▒ ▒ ▒▓▒ ▒ ░
    ░      ░▒ ░ ▒░  ▒   ▒▒ ░░ ░░   ░ ▒░░ ░▒  ░ ░  ▒   ▒▒ ░  ░  ▒       ░     ▒ ░  ░ ▒ ▒░ ░ ░░   ░ ▒░░ ░▒  ░ ░
  ░        ░░   ░   ░   ▒      ░   ░ ░ ░  ░  ░    ░   ▒   ░          ░       ▒ ░░ ░ ░ ▒     ░   ░ ░ ░  ░  ░  
            ░           ░  ░         ░       ░        ░  ░░ ░                ░      ░ ░           ░       ░  
                                                          ░                                                  
```

# What does a transaction do in the first place

COMMIT / ROLLBACK

# Where do you start a transaction



# Transaction propagation 

Propagation enum:

- Requires New 
    - Biggest known bitch in production code
- Nested 
    - sounds nice but does not work with JPA 
    - only with JDBC DataSourceTransactionManager (todo create example)
- others do not really see the use cases why 

# Propagation in Spring

- Aggregates all
    - and that is awesome!

# Propagation 

Propagation you need to know about common database errors and how they are solved:

# So there are 3 types of issues with transactions:


## Dirty Reads

|Transaction 1   |  Transaction 2 |
|---|---|
| Select * From DATA where (gives 20) |   |
|  | UPDATE DATA SET x + 1 WHERE z  |
| Select * From DATA where (gives 21) |   |

Now if Transaction 2 roles back Transaction 1 contains a dirty read

----

## Non Repeatable Reads

|Transaction 1   |  Transaction 2 |
|---|---|
| Select * From DATA where (gives 20) |   |
|  | UPDATE DATA SET x + 1 WHERE z |
|  | COMMIT; |
| Select * From DATA where (gives 21) |   |

Now Transaction 1 contains a non repeatable read

----

## Phantom Reads


|Transaction 1   |  Transaction 2 |
|---|---|
| Select * From DATA where (gives 200 rows) Limit 10 |   |
|  | INSERT 20 ROWS |
|  | COMMIT; |
| Select * From DATA where (gives 210 rows) Limit 20 |   |
| result set contains overlap and not all records |   |

----

### Table locking techniques to prevent this

Databases can use table or row locks to prevent these kind of issues, 
as you can understand the higher the locking level - the slower the performance

* Read uncommitted 
    * permits dirty reads, non repeatable reads and phantom reads.
* Read committed 
    * permits non repeatable reads and phantom reads.
* Repeatable read 
    * permits only phantom reads.
* Serializable 
    * does not permit any read errors.
    
---

Well let's see what would suits our use-case:

* POSTGRES default = Read committed
* ORACLE Read commited OR serializble (NO OTHER SUPPORT)

So it doesn't feel like we should really deep dive into the others besides 
READ COMMITTED

(change my mind ...)


# Why the hell did I dive into transactions?

Oh yes! Our live issue:


Solve it with versioning!

Spring / Hibernate @Version 

# Inspiraton of the day

@History ?!
